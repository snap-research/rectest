model:
  _target_: recommender.rec_model.Caser
  hidden_size: 64
  item_num: null # updated in code
  state_size: 10 # Max Sequence Length
  num_filters: 16
  filter_sizes: [2, 3, 4]
  dropout: 0.1
  no_id: false
  extra_embeddings: null

optimizer:
  _target_: torch.optim.Adam
  lr: 0.001
  weight_decay: 1e-6
  eps: 1e-8

scheduler:
  _target_: torch.optim.lr_scheduler.StepLR
  step_size: 10
  gamma: 0.9

collator_train:
  _target_: baselines.collators.IDOnlyCollateFn
  option: 'random'
  num_candidates: 100

collator_val:
  _target_: baselines.collators.IDOnlyCollateFn
  option: 'random'
  num_candidates: -1

dataset:
  _target_: baselines.dataloading.SequentialIterableDataset
  data_path: data_experiments/amazon_reviews_2018/Video_Games
  min_seq_len: 1
  max_seq_len: 10

# training
epochs: 1000
batch_size_train: 64
batch_size_val: 128
early_stopping: 20
seed: 43
gradient_accumulation_steps: 2
# evaluation
eval_at_start: true
eval_steps: 233
# metrics
metric_ks: 10
save_metric: 'NDCG@10'
# infrastructure
device: 'cuda'
number_of_devices: 2
fp16: true
# results/checkpoints
accelerate_checkpoint: null
output_dir: 'caser'
